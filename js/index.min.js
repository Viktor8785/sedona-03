const link=document.querySelector(".navigation-item-info"),close=document.querySelector(".modal-close"),popup=document.querySelector(".modal-adv");let adultsNumber=document.querySelector("[name=adults]"),childrenNumber=document.querySelector("[name=children]");const adultsMinus=document.querySelector(".search-number.search-minus.adults"),adultsPlus=document.querySelector(".search-number.search-plus.adults"),childrenMinus=document.querySelector(".search-number.search-minus.children"),childrenPlus=document.querySelector(".search-number.search-plus.children"),searchDateIn=document.querySelector(".search-date-in"),searchDateOut=document.querySelector(".search-date-out"),dateOutInput=document.querySelector("#search-departure-date"),dateInInput=document.querySelector("#search-arrival-date");let months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsInput=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],weekdays=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],currentDate=new Date,currentMonth=currentDate.getMonth(),currentYear=currentDate.getFullYear(),prevMonth=document.getElementById("prev-month"),nextMonth=document.getElementById("next-month"),monthCurrent=document.getElementById("month-current"),yearSelect=document.getElementById("year-select"),calendarBody=document.getElementById("calendar-body");const calendarWrapper=document.querySelector(".calendar-wrapper"),buttonClose=document.querySelector(".button-close");let dateIn=!1,dateOut=!1;function keyDown(e){if("Escape"===e.key&&popup.classList.contains("modal-adv-show")){e.preventDefault(),popup.classList.remove("modal-adv-show");const t=document.activeElement;t.blur()}if("Escape"===e.key&&calendarWrapper.classList.contains("calendar-active")){e.preventDefault(),calendarWrapper.classList.remove("calendar-active");const r=document.activeElement;r.blur()}}function numberMinus(e){var t=Number(e.value);0<t&&(e.value=String(--t))}function numberPlus(e){var t=Number(e.value);t<99&&(e.value=String(++t))}function pastInput(e){dateIn&&(dateIn=!1,inputFormatter(e,dateInInput)),dateOut&&(dateOut=!1,inputFormatter(e,dateOutInput)),calendarWrapper.classList.remove("calendar-active");const t=document.activeElement;t.blur()}function inputFormatter(e,t){e=e.innerHTML+" "+monthsInput[currentMonth]+" "+currentYear;t.value=e}function createYears(){for(i=1900;i<=2100;i++){let e=document.createElement("option");e.value=i,i==currentYear&&(e.selected=!0);var t=document.createTextNode(i);e.appendChild(t),yearSelect.appendChild(e)}}function init(){createYears(),showCalendar(currentYear,currentMonth)}function showCalendar(t,r){var n=new Date(t,r).getDay()-1,e=32-new Date(t,r,32).getDate();calendarBody.innerHTML="",monthCurrent.innerHTML=months[r];let a=!1,c=0,u=1;for(var l=0;l<6&&!a;l++){for(var d=document.createElement("tr"),o=0;o<7;o++)if(0===l&&o<n){let e=document.createElement("td");var s=document.createTextNode(new Date(t,r,-n+o+1).getDate());e.classList.add("prev-month"),e.appendChild(s),d.appendChild(e),c++}else{if(u>e&&!a){var i=7-(u+c-1)%7;if(0==i||7==i)break;for(let t=1;t<=i;t++){let e=document.createElement("td");var m=document.createTextNode(t);e.classList.add("next-month"),e.appendChild(m),d.appendChild(e)}a=!0;break}{let e=document.createElement("td");s=document.createTextNode(u);u===currentDate.getDate()&&t===currentDate.getFullYear()&&r===currentDate.getMonth()&&e.classList.add("today"),e.classList.add("this-month"),e.appendChild(s),d.appendChild(e),u++}}calendarBody.appendChild(d)}}link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-adv-show")}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-adv-show")}),window.addEventListener("keydown",e=>{keyDown(e)}),adultsMinus.addEventListener("click",e=>{e.preventDefault(),numberMinus(adultsNumber)}),adultsPlus.addEventListener("click",e=>{e.preventDefault(),numberPlus(adultsNumber)}),childrenMinus.addEventListener("click",e=>{e.preventDefault(),numberMinus(childrenNumber)}),childrenPlus.addEventListener("click",e=>{e.preventDefault(),numberPlus(childrenNumber)}),searchDateIn.addEventListener("click",e=>{calendarWrapper.classList.contains("calendar-active")||(dateIn=!0,currentYear=currentDate.getFullYear(),currentMonth=currentDate.getMonth(),yearSelect.value=currentYear,showCalendar(currentYear,currentMonth),calendarWrapper.classList.add("calendar-active"))}),searchDateOut.addEventListener("click",e=>{calendarWrapper.classList.contains("calendar-active")||(dateOut=!0,currentYear=currentDate.getFullYear(),currentMonth=currentDate.getMonth(),yearSelect.value=currentYear,showCalendar(currentYear,currentMonth),calendarWrapper.classList.add("calendar-active"))}),buttonClose.addEventListener("click",e=>{e.preventDefault(),calendarWrapper.classList.remove("calendar-active")}),calendarWrapper.onclick=e=>{e=e.target;"TD"==e.tagName&&pastInput(e)},prevMonth.addEventListener("click",()=>{0===currentMonth?(currentYear--,currentMonth=11,yearSelect.value=currentYear):currentMonth--,showCalendar(currentYear,currentMonth)}),nextMonth.addEventListener("click",()=>{currentYear=11===currentMonth?currentYear+1:currentYear,currentMonth=11===currentMonth?0:currentMonth+1,showCalendar(currentYear,currentMonth)}),yearSelect.onchange=function(){currentYear=yearSelect.value,showCalendar(currentYear,currentMonth)},yearSelect.onblur=function(){yearSelect.value=currentYear},init();
