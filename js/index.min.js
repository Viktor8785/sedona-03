const link=document.querySelector(".navigation-item-info"),close=document.querySelector(".modal-close"),popup=document.querySelector(".modal-adv");let adultsNumber=document.querySelector("[name=adults]"),childrenNumber=document.querySelector("[name=children]");const adultsMinus=document.querySelector(".search-number.search-minus.adults"),adultsPlus=document.querySelector(".search-number.search-plus.adults"),childrenMinus=document.querySelector(".search-number.search-minus.children"),childrenPlus=document.querySelector(".search-number.search-plus.children"),searchDateIn=document.querySelector(".search-date-in"),searchDateOut=document.querySelector(".search-date-out"),dateOutInput=document.querySelector("#search-departure-date"),dateInInput=document.querySelector("#search-arrival-date");let months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsInput=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],weekdays=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],currentDate=new Date,currentMonth=currentDate.getMonth(),currentYear=currentDate.getFullYear(),prevMonth=document.getElementById("prev-month"),nextMonth=document.getElementById("next-month"),monthCurrent=document.getElementById("month-current"),yearSelect=document.getElementById("year-select"),calendarBody=document.getElementById("calendar-body");const calendarWrapper=document.querySelector(".calendar-wrapper"),buttonClose=document.querySelector(".button-close");let dateIn=!1,dateOut=!1;function keyDown(e){if("Escape"===e.key&&popup.classList.contains("modal-adv-show")){e.preventDefault(),popup.classList.remove("modal-adv-show"),document.activeElement.blur()}if("Escape"===e.key&&calendarWrapper.classList.contains("calendar-active")){e.preventDefault(),calendarWrapper.classList.remove("calendar-active"),document.activeElement.blur()}}function numberMinus(e){let t=Number(e.value);t>0&&(e.value=String(--t))}function numberPlus(e){let t=Number(e.value);t<99&&(e.value=String(++t))}function pastInput(e){dateIn&&(dateIn=!1,inputFormatter(e,dateInInput)),dateOut&&(dateOut=!1,inputFormatter(e,dateOutInput)),calendarWrapper.classList.remove("calendar-active"),document.activeElement.blur()}function inputFormatter(e,t){let r=e.innerHTML+" "+monthsInput[currentMonth]+" "+currentYear;t.value=r}function createYears(){for(i=1900;i<=2100;i++){let e=document.createElement("option");e.value=i,i==currentYear&&(e.selected=!0);let t=document.createTextNode(i);e.appendChild(t),yearSelect.appendChild(e)}}function init(){createYears(),showCalendar(currentYear,currentMonth)}function showCalendar(e,t){let r=new Date(e,t).getDay()-1,n=32-new Date(e,t,32).getDate();calendarBody.innerHTML="",monthCurrent.innerHTML=months[t];let a=!1,c=0,u=1;for(var l=0;l<6&&!a;l++){for(var d=document.createElement("tr"),o=0;o<7;o++)if(0===l&&o<r){let n=document.createElement("td"),a=document.createTextNode(new Date(e,t,-r+o+1).getDate());n.classList.add("prev-month"),n.appendChild(a),d.appendChild(n),c++}else{if(u>n&&!a){let e=7-(u+c-1)%7;if(0==e||7==e)break;for(let t=1;t<=e;t++){let e=document.createElement("td"),r=document.createTextNode(t);e.classList.add("next-month"),e.appendChild(r),d.appendChild(e)}a=!0;break}{let r=document.createElement("td"),n=document.createTextNode(u);u===currentDate.getDate()&&e===currentDate.getFullYear()&&t===currentDate.getMonth()&&r.classList.add("today"),r.classList.add("this-month"),r.appendChild(n),d.appendChild(r),u++}}calendarBody.appendChild(d)}}link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-adv-show")}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-adv-show")}),window.addEventListener("keydown",e=>{keyDown(e)}),adultsMinus.addEventListener("click",e=>{e.preventDefault(),numberMinus(adultsNumber)}),adultsPlus.addEventListener("click",e=>{e.preventDefault(),numberPlus(adultsNumber)}),childrenMinus.addEventListener("click",e=>{e.preventDefault(),numberMinus(childrenNumber)}),childrenPlus.addEventListener("click",e=>{e.preventDefault(),numberPlus(childrenNumber)}),searchDateIn.addEventListener("click",e=>{calendarWrapper.classList.contains("calendar-active")||(dateIn=!0,currentYear=currentDate.getFullYear(),currentMonth=currentDate.getMonth(),yearSelect.value=currentYear,showCalendar(currentYear,currentMonth),calendarWrapper.classList.add("calendar-active"))}),searchDateOut.addEventListener("click",e=>{calendarWrapper.classList.contains("calendar-active")||(dateOut=!0,currentYear=currentDate.getFullYear(),currentMonth=currentDate.getMonth(),yearSelect.value=currentYear,showCalendar(currentYear,currentMonth),calendarWrapper.classList.add("calendar-active"))}),buttonClose.addEventListener("click",e=>{e.preventDefault(),calendarWrapper.classList.remove("calendar-active")}),calendarWrapper.onclick=(e=>{let t=e.target;"TD"==t.tagName&&pastInput(t)}),prevMonth.addEventListener("click",()=>{0===currentMonth?(currentYear--,currentMonth=11,yearSelect.value=currentYear):currentMonth--,showCalendar(currentYear,currentMonth)}),nextMonth.addEventListener("click",()=>{showCalendar(currentYear=11===currentMonth?currentYear+1:currentYear,currentMonth=11===currentMonth?0:currentMonth+1)}),yearSelect.onchange=function(){showCalendar(currentYear=yearSelect.value,currentMonth)},yearSelect.onblur=function(){yearSelect.value=currentYear},init();
