const link=document.querySelector(".navigation-item-info"),close=document.querySelector(".modal-close"),popup=document.querySelector(".modal-adv");let adultsNumber=document.querySelector("[name=adults]"),childrenNumber=document.querySelector("[name=children]");const adultsMinus=document.querySelector(".search-number.search-minus.adults"),adultsPlus=document.querySelector(".search-number.search-plus.adults"),childrenMinus=document.querySelector(".search-number.search-minus.children"),childrenPlus=document.querySelector(".search-number.search-plus.children"),searchDateIn=document.querySelector(".search-date-in"),searchDateOut=document.querySelector(".search-date-out"),dateOutInput=document.querySelector("#search-departure-date"),dateInInput=document.querySelector("#search-arrival-date");let months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsInput=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],weekdays=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],currentDate=new Date,currentMonth=currentDate.getMonth(),currentYear=currentDate.getFullYear(),prevMonth=document.getElementById("prev-month"),nextMonth=document.getElementById("next-month"),monthAndYear=document.getElementById("month-and-year"),calendarBody=document.getElementById("calendar-body");const calendarWrapper=document.querySelector(".calendar-wrapper"),buttonClose=document.querySelector(".button-close");let dateIn=!1,dateOut=!1;function keyDown(e){if("Escape"===e.key&&popup.classList.contains("modal-adv-show")){e.preventDefault(),popup.classList.remove("modal-adv-show"),document.activeElement.blur()}if("Escape"===e.key&&calendarWrapper.classList.contains("calendar-active")){e.preventDefault(),calendarWrapper.classList.remove("calendar-active"),document.activeElement.blur()}}function numberMinus(e){let t=Number(e.value);t>0&&(e.value=String(--t))}function numberPlus(e){let t=Number(e.value);t<99&&(e.value=String(++t))}function pastInput(e){dateIn&&(dateIn=!1,inputFormatter(e,dateInInput)),dateOut&&(dateOut=!1,inputFormatter(e,dateOutInput)),calendarWrapper.classList.remove("calendar-active"),document.activeElement.blur()}function inputFormatter(e,t){let n=e.innerHTML+" "+monthsInput[currentMonth]+" "+currentYear;t.value=n}function init(){showCalendar(currentYear,currentMonth)}function showCalendar(e,t){let n=new Date(e,t).getDay()-1,a=32-new Date(e,t,32).getDate();calendarBody.innerHTML="",monthAndYear.innerHTML=months[t]+" "+e;let r=!1,c=0,d=1;for(var u=0;u<6&&!r;u++){for(var l=document.createElement("tr"),o=0;o<7;o++)if(0===u&&o<n){let a=document.createElement("td"),r=document.createTextNode(new Date(e,t,-n+o+1).getDate());a.classList.add("prev-month"),a.appendChild(r),l.appendChild(a),c++}else{if(d>a&&!r){let e=7-(d+c-1)%7;if(0==e||7==e)break;for(let t=1;t<=e;t++){let e=document.createElement("td"),n=document.createTextNode(t);e.classList.add("next-month"),e.appendChild(n),l.appendChild(e)}r=!0;break}{let n=document.createElement("td"),a=document.createTextNode(d);d===currentDate.getDate()&&e===currentDate.getFullYear()&&t===currentDate.getMonth()&&n.classList.add("today"),n.classList.add("this-month"),n.appendChild(a),l.appendChild(n),d++}}calendarBody.appendChild(l)}}link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-adv-show")}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-adv-show")}),window.addEventListener("keydown",e=>{keyDown(e)}),adultsMinus.addEventListener("click",e=>{e.preventDefault(),numberMinus(adultsNumber)}),adultsPlus.addEventListener("click",e=>{e.preventDefault(),numberPlus(adultsNumber)}),childrenMinus.addEventListener("click",e=>{e.preventDefault(),numberMinus(childrenNumber)}),childrenPlus.addEventListener("click",e=>{e.preventDefault(),numberPlus(childrenNumber)}),searchDateIn.addEventListener("click",e=>{calendarWrapper.classList.contains("calendar-active")||(dateIn=!0,calendarWrapper.classList.add("calendar-active"))}),searchDateOut.addEventListener("click",e=>{calendarWrapper.classList.contains("calendar-active")||(dateOut=!0,calendarWrapper.classList.add("calendar-active"))}),buttonClose.addEventListener("click",e=>{e.preventDefault(),calendarWrapper.classList.remove("calendar-active")}),document.querySelector("body").addEventListener("click",function(e){calendarWrapper.classList.contains("calendar-active")&&(e.preventDefault(),dateIn&&dateInInput.focus(),dateOut&&dateOutInput.focus())}),calendarWrapper.onclick=(e=>{let t=e.target;"TD"==t.tagName&&pastInput(t)}),prevMonth.addEventListener("click",()=>{showCalendar(currentYear=0===currentMonth?currentYear-1:currentYear,currentMonth=0===currentMonth?11:currentMonth-1)}),nextMonth.addEventListener("click",()=>{showCalendar(currentYear=11===currentMonth?currentYear+1:currentYear,currentMonth=11===currentMonth?0:currentMonth+1)}),init();
